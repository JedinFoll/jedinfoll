<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jedi√± Foll ‚Äî Jeu √©ducatif, dr√¥le et strat√©gique</title>
  <link rel="alternate" hreflang="en" href="/jedinfoll/index-en.html">
  <style>
    :root{--mint:#2ec4b6;--bg:#1a1a1a}
    *{box-sizing:border-box}
    body { margin: 0; font-family: Arial, sans-serif; background-color: var(--mint); color: #fff; }
    header, footer { text-align: center; padding: 1rem; background: var(--bg); }
    main { max-width: 900px; margin: auto; padding: 1rem; }
    .topbar { display:flex; justify-content:space-between; align-items:center; max-width:900px; margin:0 auto; }
    .lang { font-weight:bold; }
    .lang a { color:#ffcb77; text-decoration:none; margin-left:.5rem; }
    .card { background: var(--bg); border-radius: 20px; padding: 1.5rem; box-shadow: 0 4px 12px rgba(0,0,0,0.5); margin: 1rem auto 2rem; }
    h1, h2 { color: #ffffff; margin:0 0 .5rem; }
    h2 { color: var(--mint); }
    .price { font-size: 1.8rem; font-weight: bold; margin: 1rem 0; }
    .btn { display: inline-block; padding: 0.8rem 1.2rem; border-radius: 10px; background: linear-gradient(90deg, #00b4d8, #ffcb77); color: #000; font-weight: bold; text-decoration: none; }
    .qr { text-align: center; margin-top: 1rem; }
    .social-links a { color: var(--mint); text-decoration: none; margin: 0 10px; font-weight: bold; }
    .mentions { font-size: 0.95rem; color: #ddd; margin-top: 1rem; text-align: left; line-height: 1.55; }
    .flags-inline { display:inline-flex; align-items:center; gap:6px; }
    .flag { height: 16px; border-radius:2px; border:1px solid #333; }
    .small { color:#bbb; font-size:.9rem }
    ul { padding-left: 1.2rem; }
    .pdf-frame { width:100%; aspect-ratio: 1/1.414; max-height:80vh; border:0; background:#fff; }
    @media (max-width:600px){ .pdf-frame{ aspect-ratio:auto; height:70vh; } }
    @media print {
      body { background: #fff; color: #000; }
      header, footer, .card:not(#rules) { display: none !important; }
      #rules { box-shadow:none; border: none; background:#fff; color:#000; }
      #rules h2 { color:#000; }
    }
    /* √âtoiles + Avis */
    .stars { font-size: 1.8rem; user-select:none; display:flex; gap:.1rem; }
    .rating-line { display:flex; align-items:center; gap:.5rem; flex-wrap:wrap; }
    .rating-summary { font-weight:bold; }
    .star-btn{
      font: inherit; background: transparent; border: none;
      padding: .1rem .2rem; cursor: pointer; line-height: 1;
      color: #aaa; transition: transform .05s ease;
    }
    .star-btn:focus{ outline: 2px dotted #ffcb77; outline-offset: 2px; }
    .star-btn.filled{ color: #ffcb77; }
    .star-btn:hover{ transform: scale(1.05); }
    .reviews-list{display:flex; flex-direction:column; gap:1rem; margin-top:1rem;}
    .review{background:#111; border:1px solid #2a2a2a; border-radius:12px; padding:1rem;}
    .review-header{display:flex; align-items:center; gap:.6rem; margin-bottom:.4rem; font-size:.95rem; color:#ddd}
    .review-author{font-weight:bold; color:#fff}
    .review-date{color:#bbb; font-size:.9rem}
    .review-stars{color:#ffcb77; letter-spacing:.05em}
    .review-body{white-space:pre-wrap; line-height:1.45}
    .reviews-actions{margin-top:.5rem}
    .reviews-actions a{color:var(--mint); text-decoration:none; font-weight:bold}
    .review-empty{color:#bbb; font-style:italic}
    textarea#reviewText{width:100%; min-height:110px; border-radius:12px; border:1px solid #2a2a2a; padding:.8rem; background:#0f0f0f; color:#fff; resize:vertical}
    .review-send{margin-top:.6rem}
  </style>
</head>
<body>
  <header>
    <div class="topbar">
      <div></div>
      <div class="lang">FR / <a href="/jedinfoll/index-en.html">EN</a></div>
    </div>
    <h1>Jedi√± Foll</h1>
    <p>Le jeu de cartes √©ducatif, dr√¥le et strat√©gique</p>
  </header>

  <main>
    <div class="card">
      <h2>Jedi√± Foll</h2>
      <ul>
        <li>1 √† 4 joueurs ¬∑ 10 √† 30 minutes</li>
        <li>√Ä partir de 6 ans</li>
        <li>5 modes de jeu ‚Äî atteindre exactement le r√©sultat demand√© selon le mode choisi</li>
        <li>La bo√Æte contient 102 cartes</li>
      </ul>
    </div>

    <div class="card" id="rules">
      <h2>R√®gles du jeu</h2>
      <p class="small">Lecture directe ci-dessous ‚Ä¢ <a class="btn" href="/jedinfoll/regles.pdf" download>T√©l√©charger le PDF</a></p>
      <object data="/jedinfoll/regles.pdf" type="application/pdf" class="pdf-frame">
        <iframe src="/jedinfoll/regles.pdf" class="pdf-frame" title="R√®gles"></iframe>
      </object>
      <p class="small">Si le PDF ne s‚Äôaffiche pas, <a href="/jedinfoll/regles.pdf" download>cliquez ici pour le t√©l√©charger</a>.</p>
      <button class="btn" onclick="window.print()">üìÑ Imprimer la section R√®gles</button>
    </div>

    <!-- VID√âO -->
    <div class="card" id="videos">
      <h2>Vid√©os</h2>
      <div style="aspect-ratio:16/9; max-width:100%;">
        <iframe width="100%" height="100%" src="https://www.youtube.com/embed/ID_DE_TA_VIDEO" title="Jedi√± Foll ‚Äî D√©mo" frameborder="0" allowfullscreen></iframe>
      </div>
    </div>

    <!-- PR√âCOMMANDE -->
    <div class="card" id="pricing">
      <h2>Pr√©commande</h2>
      <div class="price">14,99 ‚Ç¨</div>

      <!-- Pr√©commande France -->
      <a href="https://www.paypal.com/ncp/payment/PAYPAL_FRANCE_LINK" class="btn">
        üá´üá∑ Pr√©commande France ‚Äî 14,99 ‚Ç¨ + 5 ‚Ç¨ livraison
      </a>

      <!-- Pr√©commande Martinique -->
      <a href="https://www.paypal.com/ncp/payment/PAYPAL_MARTINIQUE_LINK" class="btn" style="margin-left:10px; background:linear-gradient(90deg,#06d6a0,#ffd166);">
        üá≤üá∂ Pr√©commande Martinique ‚Äî 14,99 ‚Ç¨ (Retrait sur place)
      </a>

      <p class="small" style="margin-top:.8rem;">
        ‚è≥ Disponible √† partir de <strong>mi-juin 2026</strong> (ou plus t√¥t selon la production).<br>
        üì¶ France : ajouter 5 ‚Ç¨ pour la livraison.<br>
        üìç Martinique : retrait sur place uniquement (pas d‚Äôexp√©dition).
      </p>
    </div>

    <!-- QR CODE -->
    <div class="card">
      <h2>QR Code</h2>
      <div class="qr">
        <a href="https://api.qrserver.com/v1/create-qr-code/?size=2000x2000&data=https://jedinfoll.github.io/jedinfoll/" download>
          <img src="https://api.qrserver.com/v1/create-qr-code/?size=500x500&data=https://jedinfoll.github.io/jedinfoll/" alt="QR Code vers Jedi√± Foll" style="max-width:300px;">
        </a>
      </div>
      <p class="small">Cliquez sur le QR pour t√©l√©charger en HD.</p>
    </div>

    <!-- AVIS & NOTE -->
    <div class="card" id="reviews">
      <h2>Avis & Note</h2>

      <!-- Note moyenne -->
      <div class="rating-line" style="margin-bottom:.5rem;">
        <div id="avgStars" class="stars" aria-label="Note moyenne" style="pointer-events:none;">‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ</div>
        <div class="rating-summary"><span id="avgValue">‚Äî</span> / 5 ¬∑ <span id="totalVotes">0</span> notes</div>
      </div>

      <!-- Votre note (boutons √©toiles) -->
      <div class="small">Votre note :</div>
      <div class="stars" id="rateStars" aria-label="Noter">
        <button type="button" class="star-btn" data-v="1" aria-label="1 √©toile">‚òÜ</button>
        <button type="button" class="star-btn" data-v="2" aria-label="2 √©toiles">‚òÜ</button>
        <button type="button" class="star-btn" data-v="3" aria-label="3 √©toiles">‚òÜ</button>
        <button type="button" class="star-btn" data-v="4" aria-label="4 √©toiles">‚òÜ</button>
        <button type="button" class="star-btn" data-v="5" aria-label="5 √©toiles">‚òÜ</button>
      </div>

      <!-- Formulaire avis -->
      <div class="review-form" style="margin-top:1rem;">
        <label for="reviewText" class="small">Votre avis (quelques lignes) :</label>
        <textarea id="reviewText" placeholder="Dites-nous ce que vous avez pens√© du jeu‚Ä¶"></textarea>
        <div class="review-send">
          <button class="btn" id="sendReviewBtn">‚úçÔ∏è Laisser un avis</button>
        </div>
        <p class="small" style="margin-top:.4rem;">
          üí° En cliquant, une page GitHub s‚Äôouvre avec votre avis pr√©-rempli. Validez pour le publier.
        </p>
      </div>

      <!-- Derniers avis -->
      <div class="reviews-list" id="latestReviews">
        <div class="review-empty">Chargement des derniers avis‚Ä¶</div>
      </div>

      <div class="reviews-actions">
        <a id="allReviewsLink" href="#" target="_blank" rel="noopener">Lire tous les avis</a>
      </div>
    </div>

    <div class="card mentions">
      <h2>Mentions l√©gales</h2>
      <p><strong>√âditeur :</strong> Jedi√± Foll ‚Äî Email : <a href="mailto:jedinfoll@gmail.com">jedinfoll@gmail.com</a></p>
      <p><strong>Responsable de publication :</strong> Jessica Lechertier</p>
      <p><strong>Fabrication :</strong> Cr√©√© en
        <span class="flags-inline">Martinique
          <img src="https://raw.githubusercontent.com/jedinfoll/jedinfoll/main/1000079688.jpg" alt="" class="flag">
        </span>
        et imprim√© en
        <span class="flags-inline">Bretagne
          <img src="https://upload.wikimedia.org/wikipedia/commons/2/29/Flag_of_Brittany_%28Gwenn_ha_du%29.svg" alt="" class="flag">
        </span>.
      </p>
      <p><strong>H√©bergement :</strong> GitHub Pages ‚Äî GitHub Inc., 88 Colin P Kelly Jr St, San Francisco, CA 94107, USA.</p>
      <p><strong>Propri√©t√© intellectuelle :</strong> Contenus ¬© Jedi√± Foll. Reproduction interdite sans autorisation.</p>
      <p><strong>Donn√©es personnelles :</strong> Les donn√©es collect√©es (commandes, emails) servent uniquement au traitement des achats et ne sont jamais revendues.</p>
    </div>
  </main>

  <footer>
    <div class="social-links">
      <a href="https://www.instagram.com/jedinfoll" target="_blank">Instagram: @jedinfoll</a> |
      <a href="https://www.facebook.com/Jedi%C3%B1%20Foll" target="_blank">Facebook: Jedi√± Foll</a> |
      <a href="mailto:jedinfoll@gmail.com">Email: jedinfoll@gmail.com</a>
    </div>

    <!-- COMPTEUR DE VISITES (badge image, fonctionne sans JS) -->
    <p>
      üëÅÔ∏è Visites :
      <img
        src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fjedinfoll.github.io%2Fjedinfoll&count_bg=%232EC4B6&title_bg=%231A1A1A&icon=&icon_color=%23FFFFFF&title=Visites&edge_flat=true"
        alt="Compteur de visites"
        style="vertical-align:middle; border-radius:6px"
      />
    </p>

    <p>¬© 2025 Jedi√± Foll ‚Äî Tous droits r√©serv√©s.</p>
  </footer>

  <!-- NOTE + AVIS -->
  <script>
    (function(){
      /* ---------- CONFIG R√©po pour les avis ---------- */
      const OWNER = 'jedinfoll';   // <-- change si besoin
      const REPO  = 'jedinfoll';   // <-- change si besoin
      const LABEL = 'avis';         // label appliqu√© aux issues "avis"

      /* ---------- Gestion √©toiles (CountAPI) ---------- */
      const avgStars = document.getElementById('avgStars');
      const avgValue = document.getElementById('avgValue');
      const totalVotes = document.getElementById('totalVotes');
      const rateStars = document.getElementById('rateStars');
      const starButtons = Array.from(rateStars.querySelectorAll('.star-btn'));
      const reviewText = document.getElementById('reviewText');
      const sendBtn = document.getElementById('sendReviewBtn');
      const latestReviews = document.getElementById('latestReviews');
      const allReviewsLink = document.getElementById('allReviewsLink');

      function paintStars(count){
        starButtons.forEach((btn, i) => {
          btn.textContent = (i < count) ? '‚òÖ' : '‚òÜ';
          btn.classList.toggle('filled', i < count);
        });
      }

      function paintAvg(elem, n){
        const arr = ['‚òÜ','‚òÜ','‚òÜ','‚òÜ','‚òÜ'];
        for(let i=0;i<n;i++) arr[i]='‚òÖ';
        elem.textContent = arr.join('');
      }

      function refreshRating(){
        Promise.all([1,2,3,4,5].map(v =>
          fetch(`https://api.countapi.xyz/get/jedinfoll.github.io/rating${v}`).then(r=>r.json()).catch(()=>({value:0}))
        )).then(vals=>{
          const counts = vals.map(v => Number(v?.value || 0));
          const total = counts.reduce((a,b)=>a+b,0);
          const sum = counts.reduce((a,b,i)=>a+b*(i+1),0);
          const avg = total ? sum/total : 0;
          totalVotes.textContent = total.toLocaleString('fr-FR');
          avgValue.textContent = total ? avg.toFixed(1) : '‚Äî';
          paintAvg(avgStars, Math.round(avg));
        }).catch(()=>{});
      }

      // Initial
      paintStars(0);
      refreshRating();

      // Survol / tactile : pr√©visualisation
      starButtons.forEach(btn => {
        btn.addEventListener('mouseenter', () => paintStars(Number(btn.dataset.v)));
        btn.addEventListener('mouseleave', () => paintStars(Number(rateStars.dataset.selected || 0)));
        btn.addEventListener('focus', () => paintStars(Number(btn.dataset.v)));
        btn.addEventListener('blur', () => paintStars(Number(rateStars.dataset.selected || 0)));

        // Clic / activation clavier
        const activate = () => {
          const v = Number(btn.dataset.v);
          rateStars.dataset.selected = String(v);
          paintStars(v);
          fetch(`https://api.countapi.xyz/hit/jedinfoll.github.io/rating${v}`)
            .then(()=>refreshRating()).catch(()=>{});
        };
        btn.addEventListener('click', activate);
        btn.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); activate(); }
        });
      });

      /* ---------- Lien "tous les avis" ---------- */
      const issuesQuery = `https://github.com/${OWNER}/${REPO}/issues?q=is%3Aissue+is%3Aopen+label%3A${encodeURIComponent(LABEL)}`;
      allReviewsLink.href = issuesQuery;

      /* ---------- Envoi avis (ouvre Issue pr√©-rempli) ---------- */
      sendBtn.addEventListener('click', ()=>{
        const note = Number(rateStars.dataset.selected || 0);
        const txt = (reviewText.value || '').trim();
        const stars = note ? '‚òÖ'.repeat(note) + '‚òÜ'.repeat(5 - note) : '(pas de note)';
        const title = encodeURIComponent(`Avis: ${stars}`);
        const body = encodeURIComponent(
`Note: ${note || '‚Äî'}/5
${'-'.repeat(20)}
${txt || 'Votre avis ici‚Ä¶'}

(Envoy√© depuis le site jedinfoll.github.io)`
        );

        const newIssueUrl = `https://github.com/${OWNER}/${REPO}/issues/new?title=${title}&body=${body}&labels=${encodeURIComponent(LABEL)}`;
        window.open(newIssueUrl, '_blank', 'noopener');
      });

      /* ---------- Chargement des 3 derniers avis ---------- */
      function escapeHTML(s){ return s.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }
      function renderEmpty(msg){ latestReviews.innerHTML = `<div class="review-empty">${msg}</div>`; }

      fetch(`https://api.github.com/repos/${OWNER}/${REPO}/issues?labels=${encodeURIComponent(LABEL)}&state=open&per_page=3&sort=created&direction=desc`, { cache: 'no-store' })
        .then(r => r.ok ? r.json() : Promise.reject(r))
        .then(items => {
          if (!Array.isArray(items) || items.length === 0){
            renderEmpty("Pas encore d'avis. Soyez le premier !");
            return;
          }
          latestReviews.innerHTML = items.map(it => {
            const user = (it.user && it.user.login) ? it.user.login : 'Anonyme';
            const date = new Date(it.created_at).toLocaleDateString('fr-FR');
            const body = (it.body || '').replace(/^Note:\s*.*$/mi,'').trim();
            const m = (it.title || '').match(/‚òÖ/g);
            const starsCount = m ? m.length : 0;
            const stars = '‚òÖ'.repeat(starsCount) + '‚òÜ'.repeat(5 - starsCount);

            return `
              <div class="review">
                <div class="review-header">
                  <span class="review-author">@${escapeHTML(user)}</span>
                  <span class="review-date">¬∑ ${escapeHTML(date)}</span>
                  <span class="review-stars">‚Äî ${stars}</span>
                </div>
                <div class="review-body">${body ? escapeHTML(body) : '<em>(sans texte)</em>'}</div>
              </div>
            `;
          }).join('');
        })
        .catch(() => renderEmpty("Impossible de charger les avis pour le moment."));
    })();
  </script>
</body>
</html>
